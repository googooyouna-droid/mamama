# 🌱 마음일기장 (웹 → 앱 전환형)

**정서 교류형 부모·자녀 일기 앱**

- 버전: 1.0 (1가족용 MVP)
- 플랫폼: Flutter Web → Firebase Hosting → Android 전환

---

## 📋 기획서 목차

1. [프로젝트 개요](#1-프로젝트-개요)
2. [주요 기능 요약](#2-주요-기능-요약)
3. [사용자 흐름](#3-사용자-흐름-user-flow)
4. [화면 설계](#4-화면-설계-요약-ui-구조)
5. [감정 및 댓글 규칙](#5-감정-및-댓글-규칙)
6. [오프라인 및 동기화 처리](#6-오프라인-및-동기화-처리)
7. [데이터 구조](#7-데이터-구조-예시-firestore--storage)
8. [기술 스택](#8-기술-스택)
9. [개발 일정](#9-개발-일정)
10. [차후 확장 계획](#-차후-확장-계획)
11. [부록](#-부록)
12. [최종 요약](#-최종-요약)

## 1️⃣. 프로젝트 개요

**앱 이름**: 마음일기장

**목적**: 부모와 자녀가 하루의 감정과 생각을 글, 이모티콘, 사진으로 공유하며 정서적 교감을 형성하는 공간

**핵심 가치**: "글이 아닌 마음으로 대화하기"

**형태**: 가족별 비공개 공간 (가족 PIN 기반 접근)

**구성**: 부모 1명, 자녀 1명 기준 MVP

## 2️⃣. 주요 기능 요약

| 구분 | 기능 | 설명 |
|------|------|------|
| 가족 로그인 | PIN 입력 | 한 가족 전용 암호로 접근 |
| 역할 선택 | 부모/자녀 버튼 | 각자 고유 화면(일기 작성 위치/색 구분) |
| 달력 보기 | 한 달 단위 일기 목록 | 날짜별 대표 감정 이모티콘 표시 |
| 일기 작성 | 부모/자녀 구역 분리 | 본인만 수정, 서로 댓글 가능 |
| 감정 표현 | 이모티콘 선택 | 텍스트 없이 감정만 남기기 가능 |
| 사진 첨부 | 본문 아래 📎 버튼 | 하루의 기록에 사진 추가 |
| 댓글 교환 | 3단 구조 | 부모 ↔ 자녀 간 감정 교류 |
| 오프라인 작성 | Firestore 캐시 | 인터넷 없이 작성 가능, 자동 업로드 |
| 백업 | JSON 다운로드 | 가족별 데이터 보존 가능 |

## 3️⃣. 사용자 흐름 (User Flow)

### 📱 기본 흐름
```
[앱 실행]
   ↓
🌱 메인화면 (수채화 배경)
   ↓
가족 PIN 입력 → [마음공간으로 들어가기]
   ↓
부모/자녀 선택
   ↓
달력 화면 (이번 달)
   ↓
날짜 클릭 → 일기 한 장 열기
   ↓
부모/자녀가 각자 일기 작성
   ↓
댓글 또는 스티커로 교감
   ↓
[저장하기] → 달력 복귀
```

### 🔄 상세 사용자 시나리오
1. **첫 방문**: 가족 PIN 설정 (4-6자리 숫자)
2. **일상 사용**: PIN 입력 → 역할 선택 → 일기 작성/조회
3. **오프라인 상황**: 작성 후 자동 저장, 온라인 시 동기화
4. **감정 교류**: 이모티콘 + 댓글 + 스티커로 소통

## 4️⃣. 화면 설계 요약 (UI 구조)

### 🌷 메인화면(Home)
- **배경**: 수채화 톤(푸른 하늘+꽃밭)
- **요소**:
  - 로고: "🌱 마음일기장" (손글씨체)
  - 가족 PIN 입력창: "가족 암호를 입력하세요 🔒"
  - 버튼: "마음공간으로 들어가기"
  - 부모/자녀 선택 버튼 (각각 일러스트)
  - 랜덤 문구: "오늘의 마음을 씨앗처럼 심어볼까요?"

### 📅 달력 화면(Calendar)
- 한글 기본 달력
- 이번 달만 표시 (이전/다음 달 이동 없음)
- 각 날짜: 대표 감정 이모티콘 1개 표시
- 날짜 클릭 → 해당 일기 페이지로 이동

### 📖 일기 페이지(Diary)
- **상단**: 날짜 (예: 2025년 10월 16일)
- **프레임 구조**:
  - 위쪽: 자녀 구역 (연하늘색 배경)
  - 아래쪽: 부모 구역 (연살구색 배경)
- **기능**:
  - 본문 작성
  - 감정 이모티콘 선택
  - 사진 첨부 (본문 아래 📎 버튼)
  - 댓글 3단 교환
- **하단**: 저장, 홈으로

## 5️⃣. 감정 및 댓글 규칙

### 💞 감정 이모티콘 표시
- 부모와 자녀 감정이 같음 → 동일 이모티콘
- 다름 → 😐 중립 표시
- 한쪽만 선택 → 선택한 쪽 이모티콘
- 모두 없음 → 🌱 기본 표시

### 💬 댓글 구조
- **위치**: 서로의 일기 영역 안쪽
- **깊이 제한**: 3단 (댓글 → 답글 → 재답글)
- **권한**: 자신의 영역 수정 가능 / 상대방 댓글에는 답글만
- **감정스티커**: ❤️ 👍 🌸 등 추가 가능

## 6️⃣. 오프라인 및 동기화 처리

### 🔄 동기화 전략
- **오프라인 작성**: Firestore 로컬 캐시에 임시저장
- **자동 동기화**: 연결 복구 시 Firebase Storage/Firestore로 자동 업로드
- **충돌 해결**: 마지막 수정 시간 기준으로 덮어쓰기

### 📊 상태 표시 시스템
- **썸네일 표시**: ⌛(대기), 🔄(업로드 중), ✅(완료), ⚠️(실패)
- **상단 알림**: "오프라인 작성 저장됨 · 연결 시 자동 업로드"
- **사용자 제어**: 업로드 실패 시 '재시도' 버튼 활성화

### 🛡️ 데이터 안전성
- **로컬 백업**: 작성 중인 데이터 자동 저장 (5초마다)
- **복구 기능**: 앱 재시작 시 미저장 데이터 복구
- **용량 관리**: 로컬 캐시 50MB 제한, 오래된 데이터 자동 정리

## 7️⃣. 데이터 구조 예시 (Firestore + Storage)

```json
{
  "familyId": "abcd1234",
  "date": "2025-10-16",
  "child": {
    "text": "오늘 그림 그렸어!",
    "photos": [
      {
        "url": "https://firebasestorage.googleapis.com/v0/b/mind-diary/photos/child1.png",
        "uploadedAt": "2025-10-16T10:32:00Z"
      }
    ],
    "emotion": "😊"
  },
  "parent": {
    "text": "그림 정말 예쁘게 그렸구나 💛",
    "photos": [],
    "emotion": "💛"
  },
  "comments": [
    {"target": "child", "user": "parent", "text": "엄마가 너무 뿌듯해!"},
    {"target": "parent", "user": "child", "text": "엄마 고마워!"}
  ],
  "calendarEmoji": "😊"
}
```

### 📂 Storage 경로 예시
```
families/{familyId}/photos/{date}/{filename}.png
```

## 8️⃣. 기술 스택

| 구분 | 기술 | 용도 |
|------|------|------|
| Frontend | Flutter | Web + Android 빌드 |
| Backend | Firebase | Auth, Firestore, Storage |
| Hosting | Firebase Hosting | 웹 버전 배포 |
| DB 구조 | Firestore (문서형) | 일기/감정/댓글 저장 |
| Storage | Firebase Storage | 사진 파일 저장 |
| 배포 | Play Console (내부 테스트) | 앱 시연 및 과제용 배포 |

## 9️⃣. 개발 일정

| 단계 | 내용 | 기간 |
|------|------|------|
| D1 | Firebase 프로젝트 생성 및 연결 | 1일 |
| D2 | 메인/역할/달력 페이지 UI 설계 | 1일 |
| D3 | 일기 작성, 댓글, 감정, 사진 기능 구현 | 2일 |
| D4 | 오프라인 캐시 + 자동 동기화 테스트 | 1일 |
| D5 | Firebase Hosting 배포 및 시연 준비 | 1일 |

## 🔟. 차후 확장 계획

- 여러 가족 지원 (가족별 데이터 독립 저장)
- 알림 기능 (상대방이 댓글 달면 푸시)
- 감정 통계 그래프 추가
- Play Store 공식 등록
- iOS 대응

## 📎 부록

### 대표 감정 이모티콘 세트
😊 😢 😡 😴 😍 😐 🌱

### 폰트 제안
배민도현체, 여름체, 나눔손글씨체

### 대표 문구 세트
- "오늘의 마음을 씨앗처럼 심어볼까요?"
- "작은 기록이 큰 마음이 됩니다."
- "하루의 색깔을 남겨보세요."

## 📘 최종 요약

### 🎯 핵심 가치
**마음일기장**은 부모와 자녀가 하루의 감정을 교류하고, 서로의 마음을 스티커·댓글·이모티콘으로 표현할 수 있는 감정형 디지털 일기장 앱입니다.

### 🚀 MVP 특징
- **한 가족 전용** 웹 버전으로 시작
- **Firebase Hosting**에서 작동
- **Android 앱**으로 손쉽게 확장 가능
- **오프라인 지원**으로 언제든 작성 가능

### 💡 차별화 포인트
1. **감정 중심** - 단순 텍스트가 아닌 감정 교류
2. **가족 전용** - 안전한 사적 공간
3. **오프라인 우선** - 네트워크 없이도 사용 가능
4. **직관적 UI** - 수채화 톤의 따뜻한 디자인

---

## 📄 PDF 생성 코드

```python
from reportlab.lib.pagesizes import A4
from reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle
from reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer, Table, TableStyle
from reportlab.lib import colors

# PDF 파일 경로
pdf_path = "마음일기장_기획서최종_v1.pdf"

# 문서 설정
doc = SimpleDocTemplate(pdf_path, pagesize=A4, rightMargin=40, leftMargin=40, topMargin=50, bottomMargin=40)
styles = getSampleStyleSheet()
styleN = ParagraphStyle("Normal", fontSize=10, leading=14)
styleH = ParagraphStyle("Heading1", fontSize=14, leading=18, spaceAfter=10, textColor=colors.darkblue)
styleH2 = ParagraphStyle("Heading2", fontSize=12, leading=16, spaceAfter=6, textColor=colors.darkgreen)

story = []

# 제목
story.append(Paragraph("🌱 마음일기장 (웹 → 앱 전환형)", styleH))
story.append(Paragraph("정서 교류형 부모·자녀 일기 앱 | 버전 1.0 (1가족용 MVP)", styleN))
story.append(Spacer(1, 12))

# 1️⃣ 프로젝트 개요
story.append(Paragraph("1️⃣ 프로젝트 개요", styleH2))
story.append(Paragraph(
    "앱 이름: 마음일기장<br/>"
    "목적: 부모와 자녀가 하루의 감정과 생각을 글, 이모티콘, 사진으로 공유하며 정서적 교감을 형성하는 공간<br/>"
    "형태: 가족별 비공개 공간 (가족 PIN 기반 접근)<br/>"
    "구성: 부모 1명, 자녀 1명 기준 MVP", styleN))
story.append(Spacer(1, 12))

# 2️⃣ 주요 기능 요약
story.append(Paragraph("2️⃣ 주요 기능 요약", styleH2))
data = [
    ["가족 로그인", "PIN 입력", "한 가족 전용 암호로 접근"],
    ["역할 선택", "부모/자녀 버튼", "각자 고유 화면(일기 작성 위치/색 구분)"],
    ["달력 보기", "한 달 단위 일기 목록", "날짜별 대표 감정 이모티콘 표시"],
    ["일기 작성", "부모/자녀 구역 분리", "본인만 수정, 서로 댓글 가능"],
    ["감정 표현", "이모티콘 선택", "텍스트 없이 감정만 남기기 가능"],
    ["사진 첨부", "본문 아래 📎 버튼", "하루의 기록에 사진 추가"],
    ["댓글 교환", "3단 구조", "부모 ↔ 자녀 간 감정 교류"],
    ["오프라인 작성", "Firestore 캐시", "인터넷 없이 작성 가능, 자동 업로드"],
    ["백업", "JSON 다운로드", "가족별 데이터 보존 가능"],
]
table = Table(data, colWidths=[90, 90, 280])
table.setStyle(TableStyle([("GRID", (0, 0), (-1, -1), 0.5, colors.grey),
                           ("BACKGROUND", (0, 0), (-1, 0), colors.whitesmoke),
                           ("VALIGN", (0, 0), (-1, -1), "TOP")]))
story.append(table)
story.append(Spacer(1, 12))

# 3️⃣ 사용자 흐름
story.append(Paragraph("3️⃣ 사용자 흐름 (User Flow)", styleH2))
story.append(Paragraph(
    "[앱 실행] → 메인화면 (수채화 배경) → 가족 PIN 입력 → 역할선택 → 달력 화면 → 날짜 클릭 → 일기 작성 → 댓글 교류 → 저장 → 달력 복귀",
    styleN))
story.append(Spacer(1, 12))

# 4️⃣ 화면 설계
story.append(Paragraph("4️⃣ 화면 설계 요약 (UI 구조)", styleH2))
story.append(Paragraph(
    "① 메인화면: 수채화 톤 배경, 가족 PIN 입력창, 부모/자녀 버튼, '마음공간으로 들어가기' 버튼.<br/>"
    "② 달력화면: 이번 달만 표시, 날짜별 감정 이모티콘 1개.<br/>"
    "③ 일기화면: 위(자녀)·아래(부모) 영역 구분, 감정/사진/댓글/저장 기능 포함.", styleN))
story.append(Spacer(1, 12))

# 5️⃣ 감정 및 댓글 규칙
story.append(Paragraph("5️⃣ 감정 및 댓글 규칙", styleH2))
story.append(Paragraph(
    "감정 이모티콘: 동일 → 같은 이모티콘 / 다름 → 😐 / 한쪽만 선택 → 선택한 쪽 / 없음 → 🌱 기본 표시.<br/>"
    "댓글: 3단 구조 (댓글→답글→재답글), 상대방 일기엔 답글만 가능, 스티커(❤️👍🌸) 가능.",
    styleN))
story.append(Spacer(1, 12))

# 6️⃣ 오프라인 처리
story.append(Paragraph("6️⃣ 오프라인 및 동기화 처리", styleH2))
story.append(Paragraph(
    "Firestore 로컬 캐시로 임시 저장 후 연결 시 자동 업로드. "
    "상태 표시(⌛,🔄,✅,⚠️)와 상단 메시지('오프라인 작성 저장됨·자동 업로드') 제공. "
    "업로드 실패 시 재시도 버튼 활성화.", styleN))
story.append(Spacer(1, 12))

# 7️⃣ 데이터 구조
story.append(Paragraph("7️⃣ 데이터 구조 (Firestore + Storage)", styleH2))
story.append(Paragraph(
    "families/{familyId}/diaries/{date}<br/>"
    "각 문서: child, parent, comments 필드 구성.<br/>"
    "사진 경로: families/{familyId}/photos/{date}/{filename}.png",
    styleN))
story.append(Spacer(1, 12))

# 8️⃣ 기술 스택
story.append(Paragraph("8️⃣ 기술 스택", styleH2))
tech = [
    ["Frontend", "Flutter", "Web + Android 빌드"],
    ["Backend", "Firebase", "Auth, Firestore, Storage"],
    ["Hosting", "Firebase Hosting", "웹 버전 배포"],
    ["DB 구조", "Firestore (문서형)", "일기/감정/댓글 저장"],
    ["Storage", "Firebase Storage", "사진 파일 저장"],
    ["배포", "Play Console (내부 테스트)", "앱 시연 및 과제용 배포"]
]
tech_table = Table(tech, colWidths=[80, 120, 260])
tech_table.setStyle(TableStyle([("GRID", (0, 0), (-1, -1), 0.5, colors.grey)]))
story.append(tech_table)
story.append(Spacer(1, 12))

# 9️⃣ 개발 일정
story.append(Paragraph("9️⃣ 개발 일정", styleH2))
schedule = [
    ["D1", "Firebase 프로젝트 생성 및 연결", "1일"],
    ["D2", "메인/역할/달력 UI 설계", "1일"],
    ["D3", "일기·댓글·감정·사진 기능 구현", "2일"],
    ["D4", "오프라인 캐시 + 동기화 테스트", "1일"],
    ["D5", "Firebase Hosting 배포 및 시연", "1일"]
]
table3 = Table(schedule, colWidths=[50, 280, 100])
table3.setStyle(TableStyle([("GRID", (0, 0), (-1, -1), 0.5, colors.grey)]))
story.append(table3)
story.append(Spacer(1, 12))

# 10️⃣ 확장 계획
story.append(Paragraph("🔟 차후 확장 계획", styleH2))
story.append(Paragraph(
    "• 여러 가족 지원<br/>• 알림 기능(댓글 알림)<br/>• 감정 통계 그래프<br/>• Play Store 정식 등록<br/>• iOS 대응",
    styleN))
story.append(Spacer(1, 12))

# 저장
doc.build(story)
print(f"PDF 생성 완료: {pdf_path}")
```

---

**📅 작성일**: 2025년 1월 16일  
**👤 작성자**: 파이썬 기초 수업 학생  
**📝 버전**: 최종 v1.0
